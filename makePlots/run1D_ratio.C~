//Code to make run number ratio plots
// Sam Grant - Feb 2019

#include <iostream>
#include "TFile.h"
#include "TH1D.h"
#include "TCanvas.h"
#include "TAxis.h"
#include "TObject.h"

using namespace std;

int main() {
  
  const int stn = 12;

  string h1 = "St"+to_string(stn)+"_mu_run_0";
  string h2 = "St"+to_string(stn)+"_mu_run_1";

  string fname1 = "../plots/stn"+to_string(stn)+"_run_ratio.pdf";;
 
  string title1 = "Stn "+to_string(stn)+" | Population Ratio between Upper and Lower Regions;Run Number;Ratio";

  TFile *f1 = TFile::Open("../cluster_split/merged_split.root");
 
  TH1D *lower = (TH1D*)f1->Get(h1.c_str());
  TH1D *upper= (TH1D*)f1->Get(h2.c_str());

  // Save 
  f1->Save();

  //Take ratio
  TH1D *ratio = (TH1D*)upper -> Clone("ratio");

  ratio -> Divide(lower);


  for (int i=0; i!=71; ++i) {

    int label = 15921+i;

    ratio->GetXaxis()->SetBinLabel(i+1, to_string(label).c_str());

   }

  TCanvas *c1 = new TCanvas();//"c1","c1",200,10,1500,1000);
  c1->SetWindowSize(150,10);
  c1->SetCanvasSize(1200,600);
  c1->SetBottomMargin(0.15);
  ratio->GetYaxis()->SetTitleOffset(1);
  ratio->SetMarkerColor(kMagenta+2);
  ratio->SetLineColor(kMagenta+2);
  ratio->SetStats(0);
  ratio->GetXaxis()->SetTitleOffset(2);
  ratio->GetXaxis()->SetNdivisions(-69);
  ratio->GetXaxis()->LabelsOption("v");
  c1->SetGrid();
  ratio->SetTitle(title1.c_str());
  ratio->Draw();
  c1 -> SaveAs(fname1.c_str());

  delete c1, lower, upper, ratio, f1;
  return 0;

} 
